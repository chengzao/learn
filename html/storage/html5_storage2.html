<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>html5 web storage</title>
</head>
<body>
  <script>
    /*
    * 判断当前浏览器是否支持localStorage , sessionStorage
    * */
    if (window.localStorage) { console.log("浏览支持localStorage") } else { console.log("浏览暂不支持localStorage") }
    if (window.sessionStorage) { console.log("浏览支持sessionStorage") } else { console.log("浏览暂不支持sessionStorage") }
    //或者 if(typeof window.localStorage == 'undefined'){ 	console.log("浏览暂不支持localStorage") }



    /*
    * setItem存储value
    *用途：将value存储到key字段
    *用法：.setItem( key, value)
    * */
    sessionStorage.setItem("abc", "123");
    localStorage.setItem("www", "abc");
    /*
    * getItem获取value
    * 用途：获取指定key本地存储的值
    * 用法：getItem(key)
    * */
    var value = sessionStorage.getItem("abc");
    var site = localStorage.getItem("www");
    console.log(value)
    console.log(site)
    /*
    * removeItem删除key
    * 用途：删除指定key本地存储的值
    * 用法：.removeItem(key)
    * */
    sessionStorage.removeItem("abc");
    localStorage.removeItem("www");
    /*
    * clear
    * 用途：清除所有的key/value
    * 用法：.clear()
    * */
    sessionStorage.clear();
    localStorage.clear();
    /*
    * 其他操作方法：点操作和[]
    *
    * */
    var storage = window.localStorage;
    storage.key1 = "hello";
    storage["key2"] = "world";
    console.log(storage.key1);
    console.log(storage["key2"]);

    /*
    * localStorage和sessionStorage的key和length属性实现遍历
    * sessionStorage和localStorage提供的key()和length可以方便的实现存储的数据遍历
    * */
    var storage1 = window.localStorage;
    for (var i = 0, len = storage1.length; i < len; i++) {
      var key = storage1.key(i);
      var value = storage1.getItem(key);
      console.log(key + "=" + value);
    }

    /*
    * storage事件
    * storage还提供了storage事件，当键值改变或者clear的时候，就可以触发storage事件
    * */
    if (window.addEventListener) {
      window.addEventListener("storage", handle_storage, false);
    } else if (window.attachEvent) {
      window.attachEvent("onstorage", handle_storage);
    }
    function handle_storage(e) { if (!e) { e = window.event; } }
  </script>
</body>
</html>